

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Fitting &mdash; flaremodel 0.2.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="Examples.html" />
    <link rel="prev" title="Temporal Evolution" href="TempEvolution.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> flaremodel
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="EDist.html">Electron Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Utils.html">Low Level Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="Geometries.html">Geometries</a></li>
<li class="toctree-l1"><a class="reference internal" href="TempEvolution.html">Temporal Evolution</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="LICENSE.html">LICENSE</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">flaremodel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Fitting</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Fitting.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fitting">
<h1>Fitting<a class="headerlink" href="#fitting" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="flaremodel.SEDFitLM">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">SEDFitLM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flaremodel.SEDFitLM" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is a wrapper around <a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html#lmfit.minimizer.Minimizer">lmfit.Minimizer</a> class from lmfit package.
It is designed to provide more friendly interface for SED Fitting purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>list</em>) – Data in the form of list with nu, L_nu, L_nu_err values, each as 1-D np.ndarray</p></li>
<li><p><strong>p0</strong> (<em>list</em>) – Initial guess for fit [None]</p></li>
<li><p><strong>bounds_l</strong> (<em>list</em>) – List of lower limits [None]</p></li>
<li><p><strong>bounds_h</strong> (<em>list</em>) – List of upper limits [None]</p></li>
<li><p><strong>vary</strong> (<em>list</em>) – List of bools, wheter or not to vary a given params [None]</p></li>
<li><p><strong>params</strong> (<em>list</em>) – <cite>lmfit.Parameters</cite> class which alternatively overrides; p0, bounds_l, bounds_h, vary</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="flaremodel.SEDFitLM.edist_fun_from_fit">
<span class="sig-name descname"><span class="pre">edist_fun_from_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flaremodel.SEDFitLM.edist_fun_from_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the electron distribution of the best fit for a given gamma.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gamma</strong> (<em>np.array</em>) – the gamma values at which the electron distribution is evaluted</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dn/dgamma/dV</strong> – The values of the electron distribution of the best fit, given gamma</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flaremodel.SEDFitLM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flaremodel.SEDFitLM.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Interface to <a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html#lmfit.minimizer.Minimizer.minimize">lmfit.Minimizer.minimize</a>. After successful execeution the result is stored in SEDFitLM.MinimizerResult
with the same format as <a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html#minimizerresult-the-optimization-result">lmfit.Minimizer.MinimizerResult</a>.</p>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs_for_emcee</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nsamples&quot;</span><span class="p">:</span><span class="mi">400</span><span class="p">,</span> <span class="s2">&quot;nwalkers&quot;</span><span class="p">:</span><span class="mi">400</span><span class="p">,</span> <span class="s2">&quot;nsteps&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitobject</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;emcee&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwags_for_emcee</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – args for <a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html#lmfit.minimizer.Minimizer.minimize">lmfit.Minimizer.minimize</a></p></li>
<li><p><strong>**kwargs</strong> – kwargs for <a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html#lmfit.minimizer.Minimizer.minimize">lmfit.Minimizer.minimize</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flaremodel.SEDFitLM.fit_fun">
<span class="sig-name descname"><span class="pre">fit_fun</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flaremodel.SEDFitLM.fit_fun" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the model function for given nu and <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters">lmfit.Parameters</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nu</strong> (<em>np.ndarray</em>) – nu values at which to evalute model functions</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters">lmfit.Parameters</a>) – Parameters at which to evalute model functions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>luminosity</strong> – Evaluates the total SED for a set of defined models [erg s-1]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flaremodel.SEDFitLM.guess">
<span class="sig-name descname"><span class="pre">guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flaremodel.SEDFitLM.guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the fit using <cite>lmfit.Minimizer.minimize</cite> with “Nelder-Mead” method
and updates the <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.params</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>dict</em>) – keyword arguements pass self.fit</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flaremodel.SEDFitLM.plot_data">
<span class="sig-name descname"><span class="pre">plot_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_for_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flaremodel.SEDFitLM.plot_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot of the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html">matplotlib.pyplot.axis</a>) – axis object to which the data plot is added</p></li>
<li><p><strong>kwargs_for_data</strong> (<em>dict</em>) – kwargs for <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.errorbar.html">matplotlib.pyplot.errorbar</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">plot_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_for_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot of the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html">matplotlib.pyplot.axis</a>) – axis object to which the data plot is added</p></li>
<li><p><strong>kwargs_for_data</strong> (<em>dict</em>) – kwargs for <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.errorbar.html">matplotlib.pyplot.errorbar</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flaremodel.SEDFitLM.plot_edist">
<span class="sig-name descname"><span class="pre">plot_edist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([1.00000000e+00,</span> <span class="pre">1.09698580e+00,</span> <span class="pre">1.20337784e+00,</span> <span class="pre">1.32008840e+00,</span> <span class="pre">1.44811823e+00,</span> <span class="pre">1.58856513e+00,</span> <span class="pre">1.74263339e+00,</span> <span class="pre">1.91164408e+00,</span> <span class="pre">2.09704640e+00,</span> <span class="pre">2.30043012e+00,</span> <span class="pre">2.52353917e+00,</span> <span class="pre">2.76828663e+00,</span> <span class="pre">3.03677112e+00,</span> <span class="pre">3.33129479e+00,</span> <span class="pre">3.65438307e+00,</span> <span class="pre">4.00880633e+00,</span> <span class="pre">4.39760361e+00,</span> <span class="pre">4.82410870e+00,</span> <span class="pre">5.29197874e+00,</span> <span class="pre">5.80522552e+00,</span> <span class="pre">6.36824994e+00,</span> <span class="pre">6.98587975e+00,</span> <span class="pre">7.66341087e+00,</span> <span class="pre">8.40665289e+00,</span> <span class="pre">9.22197882e+00,</span> <span class="pre">1.01163798e+01,</span> <span class="pre">1.10975250e+01,</span> <span class="pre">1.21738273e+01,</span> <span class="pre">1.33545156e+01,</span> <span class="pre">1.46497140e+01,</span> <span class="pre">1.60705282e+01,</span> <span class="pre">1.76291412e+01,</span> <span class="pre">1.93389175e+01,</span> <span class="pre">2.12145178e+01,</span> <span class="pre">2.32720248e+01,</span> <span class="pre">2.55290807e+01,</span> <span class="pre">2.80050389e+01,</span> <span class="pre">3.07211300e+01,</span> <span class="pre">3.37006433e+01,</span> <span class="pre">3.69691271e+01,</span> <span class="pre">4.05546074e+01,</span> <span class="pre">4.44878283e+01,</span> <span class="pre">4.88025158e+01,</span> <span class="pre">5.35356668e+01,</span> <span class="pre">5.87278661e+01,</span> <span class="pre">6.44236351e+01,</span> <span class="pre">7.06718127e+01,</span> <span class="pre">7.75259749e+01,</span> <span class="pre">8.50448934e+01,</span> <span class="pre">9.32930403e+01,</span> <span class="pre">1.02341140e+02,</span> <span class="pre">1.12266777e+02,</span> <span class="pre">1.23155060e+02,</span> <span class="pre">1.35099352e+02,</span> <span class="pre">1.48202071e+02,</span> <span class="pre">1.62575567e+02,</span> <span class="pre">1.78343088e+02,</span> <span class="pre">1.95639834e+02,</span> <span class="pre">2.14614120e+02,</span> <span class="pre">2.35428641e+02,</span> <span class="pre">2.58261876e+02,</span> <span class="pre">2.83309610e+02,</span> <span class="pre">3.10786619e+02,</span> <span class="pre">3.40928507e+02,</span> <span class="pre">3.73993730e+02,</span> <span class="pre">4.10265811e+02,</span> <span class="pre">4.50055768e+02,</span> <span class="pre">4.93704785e+02,</span> <span class="pre">5.41587138e+02,</span> <span class="pre">5.94113398e+02,</span> <span class="pre">6.51733960e+02,</span> <span class="pre">7.14942899e+02,</span> <span class="pre">7.84282206e+02,</span> <span class="pre">8.60346442e+02,</span> <span class="pre">9.43787828e+02,</span> <span class="pre">1.03532184e+03,</span> <span class="pre">1.13573336e+03,</span> <span class="pre">1.24588336e+03,</span> <span class="pre">1.36671636e+03,</span> <span class="pre">1.49926843e+03,</span> <span class="pre">1.64467618e+03,</span> <span class="pre">1.80418641e+03,</span> <span class="pre">1.97916687e+03,</span> <span class="pre">2.17111795e+03,</span> <span class="pre">2.38168555e+03,</span> <span class="pre">2.61267523e+03,</span> <span class="pre">2.86606762e+03,</span> <span class="pre">3.14403547e+03,</span> <span class="pre">3.44896226e+03,</span> <span class="pre">3.78346262e+03,</span> <span class="pre">4.15040476e+03,</span> <span class="pre">4.55293507e+03,</span> <span class="pre">4.99450512e+03,</span> <span class="pre">5.47890118e+03,</span> <span class="pre">6.01027678e+03,</span> <span class="pre">6.59318827e+03,</span> <span class="pre">7.23263390e+03,</span> <span class="pre">7.93409667e+03,</span> <span class="pre">8.70359136e+03,</span> <span class="pre">9.54771611e+03,</span> <span class="pre">1.04737090e+04,</span> <span class="pre">1.14895100e+04,</span> <span class="pre">1.26038293e+04,</span> <span class="pre">1.38262217e+04,</span> <span class="pre">1.51671689e+04,</span> <span class="pre">1.66381689e+04,</span> <span class="pre">1.82518349e+04,</span> <span class="pre">2.00220037e+04,</span> <span class="pre">2.19638537e+04,</span> <span class="pre">2.40940356e+04,</span> <span class="pre">2.64308149e+04,</span> <span class="pre">2.89942285e+04,</span> <span class="pre">3.18062569e+04,</span> <span class="pre">3.48910121e+04,</span> <span class="pre">3.82749448e+04,</span> <span class="pre">4.19870708e+04,</span> <span class="pre">4.60592204e+04,</span> <span class="pre">5.05263107e+04,</span> <span class="pre">5.54266452e+04,</span> <span class="pre">6.08022426e+04,</span> <span class="pre">6.66991966e+04,</span> <span class="pre">7.31680714e+04,</span> <span class="pre">8.02643352e+04,</span> <span class="pre">8.80488358e+04,</span> <span class="pre">9.65883224e+04,</span> <span class="pre">1.05956018e+05,</span> <span class="pre">1.16232247e+05,</span> <span class="pre">1.27505124e+05,</span> <span class="pre">1.39871310e+05,</span> <span class="pre">1.53436841e+05,</span> <span class="pre">1.68318035e+05,</span> <span class="pre">1.84642494e+05,</span> <span class="pre">2.02550194e+05,</span> <span class="pre">2.22194686e+05,</span> <span class="pre">2.43744415e+05,</span> <span class="pre">2.67384162e+05,</span> <span class="pre">2.93316628e+05,</span> <span class="pre">3.21764175e+05,</span> <span class="pre">3.52970730e+05,</span> <span class="pre">3.87203878e+05,</span> <span class="pre">4.24757155e+05,</span> <span class="pre">4.65952567e+05,</span> <span class="pre">5.11143348e+05,</span> <span class="pre">5.60716994e+05,</span> <span class="pre">6.15098579e+05,</span> <span class="pre">6.74754405e+05,</span> <span class="pre">7.40196000e+05,</span> <span class="pre">8.11984499e+05,</span> <span class="pre">8.90735464e+05,</span> <span class="pre">9.77124154e+05,</span> <span class="pre">1.07189132e+06,</span> <span class="pre">1.17584955e+06,</span> <span class="pre">1.28989026e+06,</span> <span class="pre">1.41499130e+06,</span> <span class="pre">1.55222536e+06,</span> <span class="pre">1.70276917e+06,</span> <span class="pre">1.86791360e+06,</span> <span class="pre">2.04907469e+06,</span> <span class="pre">2.24780583e+06,</span> <span class="pre">2.46581108e+06,</span> <span class="pre">2.70495973e+06,</span> <span class="pre">2.96730241e+06,</span> <span class="pre">3.25508860e+06,</span> <span class="pre">3.57078596e+06,</span> <span class="pre">3.91710149e+06,</span> <span class="pre">4.29700470e+06,</span> <span class="pre">4.71375313e+06,</span> <span class="pre">5.17092024e+06,</span> <span class="pre">5.67242607e+06,</span> <span class="pre">6.22257084e+06,</span> <span class="pre">6.82607183e+06,</span> <span class="pre">7.48810386e+06,</span> <span class="pre">8.21434358e+06,</span> <span class="pre">9.01101825e+06,</span> <span class="pre">9.88495905e+06,</span> <span class="pre">1.08436597e+07,</span> <span class="pre">1.18953407e+07,</span> <span class="pre">1.30490198e+07,</span> <span class="pre">1.43145894e+07,</span> <span class="pre">1.57029012e+07,</span> <span class="pre">1.72258597e+07,</span> <span class="pre">1.88965234e+07,</span> <span class="pre">2.07292178e+07,</span> <span class="pre">2.27396575e+07,</span> <span class="pre">2.49450814e+07,</span> <span class="pre">2.73644000e+07,</span> <span class="pre">3.00183581e+07,</span> <span class="pre">3.29297126e+07,</span> <span class="pre">3.61234270e+07,</span> <span class="pre">3.96268864e+07,</span> <span class="pre">4.34701316e+07,</span> <span class="pre">4.76861170e+07,</span> <span class="pre">5.23109931e+07,</span> <span class="pre">5.73844165e+07,</span> <span class="pre">6.29498899e+07,</span> <span class="pre">6.90551352e+07,</span> <span class="pre">7.57525026e+07,</span> <span class="pre">8.30994195e+07,</span> <span class="pre">9.11588830e+07,</span> <span class="pre">1.00000000e+08])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flaremodel.SEDFitLM.plot_edist" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots electron distribution of the best fit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html">matplotlib.pyplot.axis</a>, default=None) – if None, plot fit will create a new figure and axis object. Otherwise plot will be added to axis object</p></li>
<li><p><strong>gamma</strong> (<em>np.ndarray</em><em>, </em><em>default=np.logspace</em><em>(</em><em>0</em><em>, </em><em>8</em><em>, </em><em>200</em><em>)</em>) – Gamma at which the electron distribution is evaluated from best fit result.</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>default=True</em>) – if False plt.show is not called.</p></li>
<li><p><strong>xlim</strong> (<em>tuple</em><em>, </em><em>default=None</em>) – if not None, sets the xlimits of the plot</p></li>
<li><p><strong>ylim</strong> (<em>tuple</em><em>, </em><em>default=None</em>) – if not None, sets the ylimits of the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flaremodel.SEDFitLM.plot_fit">
<span class="sig-name descname"><span class="pre">plot_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([1.00000000e+10,</span> <span class="pre">1.59985872e+10,</span> <span class="pre">2.55954792e+10,</span> <span class="pre">4.09491506e+10,</span> <span class="pre">6.55128557e+10,</span> <span class="pre">1.04811313e+11,</span> <span class="pre">1.67683294e+11,</span> <span class="pre">2.68269580e+11,</span> <span class="pre">4.29193426e+11,</span> <span class="pre">6.86648845e+11,</span> <span class="pre">1.09854114e+12,</span> <span class="pre">1.75751062e+12,</span> <span class="pre">2.81176870e+12,</span> <span class="pre">4.49843267e+12,</span> <span class="pre">7.19685673e+12,</span> <span class="pre">1.15139540e+13,</span> <span class="pre">1.84206997e+13,</span> <span class="pre">2.94705170e+13,</span> <span class="pre">4.71486636e+13,</span> <span class="pre">7.54312006e+13,</span> <span class="pre">1.20679264e+14,</span> <span class="pre">1.93069773e+14,</span> <span class="pre">3.08884360e+14,</span> <span class="pre">4.94171336e+14,</span> <span class="pre">7.90604321e+14,</span> <span class="pre">1.26485522e+15,</span> <span class="pre">2.02358965e+15,</span> <span class="pre">3.23745754e+15,</span> <span class="pre">5.17947468e+15,</span> <span class="pre">8.28642773e+15,</span> <span class="pre">1.32571137e+16,</span> <span class="pre">2.12095089e+16,</span> <span class="pre">3.39322177e+16,</span> <span class="pre">5.42867544e+16,</span> <span class="pre">8.68511374e+16,</span> <span class="pre">1.38949549e+17,</span> <span class="pre">2.22299648e+17,</span> <span class="pre">3.55648031e+17,</span> <span class="pre">5.68986603e+17,</span> <span class="pre">9.10298178e+17,</span> <span class="pre">1.45634848e+18,</span> <span class="pre">2.32995181e+18,</span> <span class="pre">3.72759372e+18,</span> <span class="pre">5.96362332e+18,</span> <span class="pre">9.54095476e+18,</span> <span class="pre">1.52641797e+19,</span> <span class="pre">2.44205309e+19,</span> <span class="pre">3.90693994e+19,</span> <span class="pre">6.25055193e+19,</span> <span class="pre">1.00000000e+20])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_for_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_for_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flaremodel.SEDFitLM.plot_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots fit results</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html">matplotlib.pyplot.axis</a>, default=None) – if None, plot fit will create a new figure and axis object. Otherwise plot will be added to axis object</p></li>
<li><p><strong>nu</strong> (<em>np.ndarray</em><em>, </em><em>default=np.logspace</em><em>(</em><em>10</em><em>, </em><em>20</em><em>, </em><em>50</em><em>)</em>) – the x values for at which the best fit solution is evaluted</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>default=True</em>) – if False plt.show is not called.</p></li>
<li><p><strong>xlim</strong> (<em>tuple</em><em>, </em><em>default=None</em>) – if not None, sets the xlimits of the plot</p></li>
<li><p><strong>ylim</strong> (<em>tuple</em><em>, </em><em>default=None</em>) – if not None, sets the ylimits of the plot</p></li>
<li><p><strong>kwargs_for_data</strong> (<em>dict</em><em>, </em><em>default={}</em>) – Keywords for plt.plot to plot data.</p></li>
<li><p><strong>kwargs_for_fit</strong> (<em>dict</em>) – Keyword arguments passed to plt.plot for SED model plot. The plot of the combined fit of all models can be controlled by adding “model” to the keyword, e.g. kwargs_for_fit={“model_lw”:10, “lw”:5} sets the line width of the combined model to 10, where as the individual model components have line width 5. [{}]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flaremodel.SEDFitLM.plot_fun">
<span class="sig-name descname"><span class="pre">plot_fun</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_for_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flaremodel.SEDFitLM.plot_fun" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a plot of the fit using the best fit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nu</strong> (<em>np.ndarray</em>) – Frequencies to evalutate SED model</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters">lmfit.Parameters</a>) – Parameters to evaluate the model.</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.axis</cite>) – axis object to which the data plot is added</p></li>
<li><p><strong>kwargs_for_fit</strong> (<em>dict</em>) – keywords arguments passed to kwargs_for data. if keyword has “model” as a prefix matplotlib keyword is passed to the combined fit, else is passed to individal fits [{}]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flaremodel.SEDFitLM.plot_initial_guess">
<span class="sig-name descname"><span class="pre">plot_initial_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([1.00000000e+10,</span> <span class="pre">1.59985872e+10,</span> <span class="pre">2.55954792e+10,</span> <span class="pre">4.09491506e+10,</span> <span class="pre">6.55128557e+10,</span> <span class="pre">1.04811313e+11,</span> <span class="pre">1.67683294e+11,</span> <span class="pre">2.68269580e+11,</span> <span class="pre">4.29193426e+11,</span> <span class="pre">6.86648845e+11,</span> <span class="pre">1.09854114e+12,</span> <span class="pre">1.75751062e+12,</span> <span class="pre">2.81176870e+12,</span> <span class="pre">4.49843267e+12,</span> <span class="pre">7.19685673e+12,</span> <span class="pre">1.15139540e+13,</span> <span class="pre">1.84206997e+13,</span> <span class="pre">2.94705170e+13,</span> <span class="pre">4.71486636e+13,</span> <span class="pre">7.54312006e+13,</span> <span class="pre">1.20679264e+14,</span> <span class="pre">1.93069773e+14,</span> <span class="pre">3.08884360e+14,</span> <span class="pre">4.94171336e+14,</span> <span class="pre">7.90604321e+14,</span> <span class="pre">1.26485522e+15,</span> <span class="pre">2.02358965e+15,</span> <span class="pre">3.23745754e+15,</span> <span class="pre">5.17947468e+15,</span> <span class="pre">8.28642773e+15,</span> <span class="pre">1.32571137e+16,</span> <span class="pre">2.12095089e+16,</span> <span class="pre">3.39322177e+16,</span> <span class="pre">5.42867544e+16,</span> <span class="pre">8.68511374e+16,</span> <span class="pre">1.38949549e+17,</span> <span class="pre">2.22299648e+17,</span> <span class="pre">3.55648031e+17,</span> <span class="pre">5.68986603e+17,</span> <span class="pre">9.10298178e+17,</span> <span class="pre">1.45634848e+18,</span> <span class="pre">2.32995181e+18,</span> <span class="pre">3.72759372e+18,</span> <span class="pre">5.96362332e+18,</span> <span class="pre">9.54095476e+18,</span> <span class="pre">1.52641797e+19,</span> <span class="pre">2.44205309e+19,</span> <span class="pre">3.90693994e+19,</span> <span class="pre">6.25055193e+19,</span> <span class="pre">1.00000000e+20])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flaremodel.SEDFitLM.plot_initial_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the luminosity of the inital guess provided to the fit object, or the the initial guess provided to the function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axis.html">matplotlib.pyplot.axis</a>, default=None) – if None, plot fit will create a new figure and axis object. Otherwise plot will be added to axis object</p></li>
<li><p><strong>p0</strong> (<a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters">lmfit.Parameters</a>) – List of alternative parameters, if None uses the <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters">lmfit.Parameters</a> after <a class="reference internal" href="#flaremodel.SEDFitLM.guess" title="flaremodel.SEDFitLM.guess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SEDFitLM.guess()</span></code></a></p></li>
<li><p><strong>nu</strong> (<em>np.ndarray</em><em>, </em><em>default=np.logspace</em><em>(</em><em>10</em><em>, </em><em>20</em><em>, </em><em>50</em><em>)</em>) – Frequencies at which the best fit solution is evaluted</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>default=True</em>) – if False plt.show is not called.</p></li>
<li><p><strong>xlim</strong> (<em>tuple</em><em>, </em><em>default=None</em>) – if not None, sets the xlimits of the plot</p></li>
<li><p><strong>ylim</strong> (<em>tuple</em><em>, </em><em>default=None</em>) – if not None, sets the ylimits of the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flaremodel.SEDFitLM.report_fit">
<span class="sig-name descname"><span class="pre">report_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flaremodel.SEDFitLM.report_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around <a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html#getting-and-printing-fit-reports">lmfit.fit_report</a> to report fit results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<em>dict</em>) – kwargs for <a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html#getting-and-printing-fit-reports">lmfit.fit_report</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="TempEvolution.html" class="btn btn-neutral float-left" title="Temporal Evolution" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Yigit Dallilar, Sebastiano von Fellenberg

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>